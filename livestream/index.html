<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <title>Báo cáo livestream</title>
    <meta http-equiv="Cache-Control" content="public, max-age=31536000">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <link rel="preconnect" href="https://fonts.googleapis.com/">
    <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin="">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="../logo.jpg" />
    
    <!-- The core Firebase JS SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <!-- The Firebase storage SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-storage-compat.js"></script>
    <!-- The Firebase firestore SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
    <!-- Load jQuery from a CDN -->
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.5/xlsx.full.min.js"></script>
    
    <!-- Main CSS -->
    <link rel="stylesheet" href="../main.css">
    
    <!-- Navigation Manager - Load trước khi load page scripts -->
    <script src="../js/navigation.js"></script>
    <script src="../js/common-utils.js"></script>
</head>

<body>
    <!-- Security Indicator -->
    <div class="security-indicator" id="securityIndicator">Secure</div>
    
    <!-- Performance Indicator -->
    <div class="performance-indicator" id="performanceIndicator">Fast Load</div>
    
    <!-- Menu Toggle Button -->
    <button class="menu-toggle">
        <div class="hamburger"></div>
    </button>

    <!-- Sidebar Navigation -->
    <nav class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <h3>Menu Điều Hướng</h3>
            <button class="close-btn">&times;</button>
        </div>
        <ul class="nav-list"></ul>
    </nav>

    <!-- Overlay -->
    <div class="overlay" id="overlay"></div>

    <!-- Top buttons -->
    <div class="top-buttons">
        <button id="toggleFormButton">Hiện biểu mẫu</button>
        <button onclick="exportToExcel()" style="background: linear-gradient(135deg, #28a745 0%, #20c997 100%);">Xuất Excel</button>
        <button id="toggleLogoutButton">Đăng xuất</button>
    </div>

    <!-- Main content -->
    <div class="main-content">
        <div class="header">
            <div id="parentContainer">
                <p class="tieude">BÁO CÁO LIVESTREAM</p>
            </div>
        </div>

        <!-- Data Form -->
        <div id="dataForm" class="form-section" style="display: none;">
            <h1>Thêm Báo cáo Livestream</h1>
            <form id="livestreamForm">
                <div class="form-group">
                    <label for="ngayLive">Ngày livestream:</label>
                    <input type="date" id="ngayLive" required>
                </div>
                
                <div class="form-group">
                    <label for="mauLive">Mẫu live:</label>
                    <textarea id="mauLive" placeholder="VD: 20 mẫu" required></textarea>
                </div>
                
                <div class="form-group">
                    <label for="tienQC">Tiền QC:</label>
                    <input type="text" id="tienQC" placeholder="VD: 500,000" required>
                </div>
                
                <div class="form-group">
                    <label for="thoiGian">Thời gian:</label>
                    <input type="text" id="thoiGian" placeholder="VD: 20:00 - 22:00 hoặc 2 tiếng">
                </div>
                
                <div class="form-group">
                    <label for="soMonLive">Số món trên live:</label>
                    <input type="text" id="soMonLive" placeholder="VD: 50 món">
                </div>
                
                <div class="form-group" style="display:none;">
				  <label for="soMonInbox">Số món inbox:</label>
				  <input type="text" id="soMonInbox" value="0" placeholder="VD: 30 đơn">
				</div>
                
                <div class="center-button">
                    <button type="submit" id="addButton">Thêm</button>
                    <button type="button" id="clearDataButton">Reset</button>
                </div>
            </form>
        </div>

        <!-- Table -->
        <div class="table-container">
            <div class="ck">
                <table>
                    <thead>
                        <tr>
                            <th>Ngày</th>
                            <th>Mẫu live</th>
                            <th>Tiền QC</th>
                            <th>Thời gian</th>
                            <th>Số món trên live</th>
                            <th>Số món inbox</th>
                            <th>Chỉnh sửa</th>
                            <th>Xóa</th>
                        </tr>
                    </thead>
                    <tbody id="tableBody"></tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Modal for editing -->
	<div id="editModal" class="modal">
		<div class="modal-content" style="position: relative; max-height: 80vh; overflow-y: auto; padding: 20px;">
			<span class="close" onclick="closeModal()" 
				  style="position: sticky; top: 0; right: 0; float: right; font-size: 24px; cursor: pointer; background: white; z-index: 10; padding: 5px;">
				  &times;
			</span>
			<h2>Chỉnh sửa báo cáo livestream</h2>
			<div class="form-group">
				<label for="editDate">Ngày:</label>
				<input type="date" id="editDate">
			</div>
			<div class="form-group">
				<label for="editMauLive">Mẫu live:</label>
				<textarea id="editMauLive"></textarea>
			</div>
			<div class="form-group">
				<label for="editTienQC">Tiền QC:</label>
				<input type="text" id="editTienQC">
			</div>
			<div class="form-group">
			  <label for="editTimeInputs">Thời gian:</label>
			  <div id="thoiGianContainer" style="display: flex; flex-direction: column; gap: 8px;">
				<div style="display:flex; gap:5px; align-items:center;">
				  <span style="width:40px;">Từ</span>
				  <input type="number" id="editHh1" min="0" max="23" placeholder="HH" style="width:55px;">
				  :
				  <input type="number" id="editMm1" min="0" max="59" placeholder="MM" style="width:55px;">
				</div>
				<div style="display:flex; gap:5px; align-items:center;">
				  <span style="width:40px;">Đến</span>
				  <input type="number" id="editHh2" min="0" max="23" placeholder="HH" style="width:55px;">
				  :
				  <input type="number" id="editMm2" min="0" max="59" placeholder="MM" style="width:55px;">
				</div>
			  </div>
			</div>
			<div class="form-group">
				<label for="editSoMonLive">Số món trên live:</label>
				<input type="text" id="editSoMonLive">
			</div>
			<div class="form-group">
				<label for="editSoMonInbox">Số món inbox:</label>
				<input type="text" id="editSoMonInbox">
			</div>
			<button onclick="saveUpdatedChanges()">Lưu</button>
		</div>
	</div>

    <!-- Enhanced Floating Alert -->
    <div id="floatingAlert">
        <div class="alert-content">
            <div class="loading-spinner" style="display: none;">
                <div class="spinner"></div>
            </div>
            <div class="alert-text">Thông báo hiển thị!</div>
        </div>
    </div>
    
    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay"></div>
    
    <!-- Blocking Overlay
    <div id="blockingOverlay"></div>
    -->
    
    <!-- Tooltip -->
    <div id="tooltip" class="tooltip"></div>
    
    <!-- Original JavaScript file -->
    <script src="scriptObfuscator.js"></script>
</body>

</html>
