<!doctype html>
<html lang="vi">
    <head>
        <meta charset="UTF-8" />
        <title>Qu·∫£n l√Ω ƒë·∫∑t h√†ng</title>
        <meta http-equiv="Cache-Control" content="public, max-age=31536000" />
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />

        <!-- External CSS -->
        <link rel="stylesheet" href="styles.css" />

        <!-- JavaScript Files -->
        <script src="../js/device-detector.js"></script>
        <script src="../js/navigation.js"></script>
        <script src="../js/common-utils.js"></script>

        <!-- Firebase SDKs -->
        <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
        <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-storage-compat.js"></script>
        <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
        <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.5/xlsx.full.min.js"></script>
    </head>

    <body>
        <!-- Top buttons -->
        <div class="top-buttons">
            <button data-icon="‚ûï" id="toggleViewBtn">Hi·ªán bi·ªÉu m·∫´u</button>
            <button data-icon="üîÑ" id="refreshButton">L√†m m·ªõi d·ªØ li·ªáu</button>
            <button data-icon="üì§" id="exportButton">Xu·∫•t Excel</button>
            <button data-icon="üö™" id="logoutButton">ƒêƒÉng xu·∫•t</button>
        </div>

        <!-- Main content -->
        <div class="main-content">
            <div class="header" style="text-align: center; margin: 20px 0">
                <h1 class="page-title">QU·∫¢N L√ù ƒê·∫∂T H√ÄNG</h1>
            </div>

            <!-- Form Container (Initially hidden) -->
            <div
                id="formContainer"
                class="form-container"
                style="display: none"
            >
                <h2
                    style="
                        margin-bottom: 25px;
                        color: #2c3e50;
                        font-weight: 700;
                    "
                >
                    Th√™m ƒë∆°n ƒë·∫∑t h√†ng m·ªõi
                </h2>

                <form id="orderForm">
                    <!-- Order Information Section -->
                    <div class="form-section">
                        <h3>Th√¥ng tin ƒë∆°n h√†ng</h3>
                        <div class="form-grid">
                            <div class="form-group">
                                <label for="orderDate">Ng√†y ƒë·∫∑t h√†ng *</label>
                                <input
                                    type="date"
                                    id="orderDate"
                                    name="orderDate"
                                    required
                                />
                            </div>
                            <div class="form-group">
                                <label for="supplier">Nh√† cung c·∫•p *</label>
                                <input
                                    type="text"
                                    id="supplier"
                                    name="supplier"
                                    placeholder="Nh·∫≠p t√™n nh√† cung c·∫•p"
                                    required
                                />
                            </div>
                            <div class="form-group">
                                <label for="invoice">S·ªë h√≥a ƒë∆°n</label>
                                <input
                                    type="text"
                                    id="invoice"
                                    name="invoice"
                                    placeholder="Nh·∫≠p s·ªë h√≥a ƒë∆°n"
                                />
                            </div>
                            <div class="form-group">
                                <label for="invoiceImage">·∫¢nh h√≥a ƒë∆°n</label>
                                <div class="paste-area" id="invoiceImagePaste">
                                    <div class="paste-text">
                                        D√°n ·∫£nh h√≥a ƒë∆°n v√†o ƒë√¢y (Ctrl+V)
                                    </div>
                                    <img
                                        id="invoicePreview"
                                        class="image-preview"
                                        style="display: none"
                                    />
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Products Section -->
                    <div class="form-section">
                        <h3>Danh s√°ch s·∫£n ph·∫©m</h3>
                        <div class="products-section">
                            <table class="products-table" id="productsTable">
                                <thead>
                                    <tr>
                                        <th style="width: 15%">
                                            T√™n s·∫£n ph·∫©m *
                                        </th>
                                        <th style="width: 12%">M√£ s·∫£n ph·∫©m</th>
                                        <th style="width: 10%">Bi·∫øn th·ªÉ</th>
                                        <th style="width: 8%">S·ªë l∆∞·ª£ng *</th>
                                        <th style="width: 10%">Gi√° mua</th>
                                        <th style="width: 10%">Gi√° b√°n</th>
                                        <th style="width: 10%">·∫¢nh s·∫£n ph·∫©m</th>
                                        <th style="width: 10%">·∫¢nh gi√° mua</th>
                                        <th style="width: 10%">Ghi ch√∫</th>
                                        <th style="width: 5%">X√≥a</th>
                                    </tr>
                                </thead>
                                <tbody id="productsTableBody">
                                    <!-- Dynamic product rows will be added here -->
                                </tbody>
                            </table>
                            <button
                                type="button"
                                class="btn btn-secondary"
                                id="addProductBtn"
                            >
                                ‚ûï Th√™m s·∫£n ph·∫©m
                            </button>
                        </div>
                    </div>

                    <!-- Submit Button -->
                    <div style="text-align: center; margin-top: 30px">
                        <button
                            type="submit"
                            class="btn btn-primary"
                            id="submitBtn"
                        >
                            üíæ L∆∞u ƒë∆°n ƒë·∫∑t h√†ng
                        </button>
                    </div>
                </form>
            </div>

            <!-- Inventory Container (Original) -->
            <div id="inventoryContainer" class="inventory-container">
                <!-- Filter Section -->
                <div class="filter-section">
                    <h3>B·ªô l·ªçc d·ªØ li·ªáu</h3>
                    <div class="filter-group">
                        <div>
                            <label for="filterSupplier"
                                >Ch·ªçn nh√† cung c·∫•p:</label
                            >
                            <select id="filterSupplier">
                                <option value="all">T·∫•t c·∫£</option>
                            </select>
                        </div>
                        <div>
                            <label for="dateFromFilter">T·ª´ ng√†y:</label>
                            <input type="date" id="dateFromFilter" />
                        </div>
                        <div>
                            <label for="dateToFilter">ƒê·∫øn ng√†y:</label>
                            <input type="date" id="dateToFilter" />
                        </div>
                        <div>
                            <label for="filterProduct">L·ªçc s·∫£n ph·∫©m:</label>
                            <input
                                type="text"
                                id="filterProduct"
                                placeholder="T√¨m ki·∫øm theo t√™n ho·∫∑c m√£ s·∫£n ph·∫©m..."
                            />
                        </div>
                    </div>
                </div>

                <!-- Table Section -->
                <div class="table-container">
                    <table class="inventory-table" id="inventoryTable">
                        <thead>
                            <tr>
                                <th style="width: 8%">Ng√†y ƒë·∫∑t</th>
                                <th style="width: 10%">Nh√† cung c·∫•p</th>
                                <th style="width: 10%">H√≥a ƒë∆°n</th>
                                <th style="width: 12%">T√™n s·∫£n ph·∫©m</th>
                                <th style="width: 10%">M√£ s·∫£n ph·∫©m</th>
                                <th style="width: 8%">Bi·∫øn th·ªÉ</th>
                                <th style="width: 8%">S·ªë l∆∞·ª£ng</th>
                                <th style="width: 12%">·∫¢nh s·∫£n ph·∫©m</th>
                                <th style="width: 10%">·∫¢nh gi√° b√°n</th>
                                <th style="width: 8%">Ghi ch√∫</th>
                                <th style="width: 4%">Thao t√°c</th>
                            </tr>
                        </thead>
                        <tbody id="orderTableBody">
                            <tr class="loading-row">
                                <td
                                    colspan="11"
                                    style="
                                        text-align: center;
                                        padding: 40px;
                                        color: #6c757d;
                                        font-style: italic;
                                    "
                                >
                                    <div
                                        style="
                                            display: flex;
                                            align-items: center;
                                            justify-content: center;
                                            gap: 10px;
                                        "
                                    >
                                        <div class="loading-spinner"></div>
                                        ƒêang t·∫£i d·ªØ li·ªáu t·ª´ Firebase...
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- Statistics Section -->
                <div class="filter-section" style="margin-top: 30px">
                    <h3>Th·ªëng k√™ nhanh</h3>
                    <div class="stats-grid">
                        <div class="stat-card total">
                            <div class="stat-number" id="totalProducts">0</div>
                            <div class="stat-label">T·ªïng s·∫£n ph·∫©m</div>
                        </div>
                        <div class="stat-card completed">
                            <div class="stat-number" id="completedProducts">
                                0
                            </div>
                            <div class="stat-label">ƒê√£ ho√†n th√†nh</div>
                        </div>
                        <div class="stat-card partial">
                            <div class="stat-number" id="partialProducts">
                                0
                            </div>
                            <div class="stat-label">Nh·∫≠n m·ªôt ph·∫ßn</div>
                        </div>
                        <div class="stat-card pending">
                            <div class="stat-number" id="pendingProducts">
                                0
                            </div>
                            <div class="stat-label">Ch∆∞a nh·∫≠n</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Enhanced Floating Alert -->
        <div id="floatingAlert">
            <div class="loading-spinner"></div>
            <div class="alert-text">Th√¥ng b√°o hi·ªÉn th·ªã!</div>
        </div>

        <!-- Image Hover Overlay -->
        <div id="imageHoverOverlay" class="image-hover-overlay">
            <img id="hoverImage" src="" alt="" />
        </div>

        <!-- JavaScript Files -->
        <script src="config.js"></script>
        <script src="auth.js"></script>
        <script src="ui.js"></script>
        <script src="utils.js"></script>
        <script src="cache.js"></script>
        <script src="data-loader.js"></script>
        <script src="table-renderer.js"></script>
        <script src="filters.js"></script>
        <script src="crud-operations.js"></script>
        <script src="export.js"></script>
        <script src="ui-components.js"></script>
        <script src="form-handler.js"></script>
        <script src="main.js"></script>
    </body>
</html>
