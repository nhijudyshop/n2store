<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Qu·∫£n L√Ω S·∫£n Ph·∫©m</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 20px;
    }

    .container {
      max-width: 900px;
      margin: 0 auto;
      background: white;
      border-radius: 16px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
      padding: 30px;
    }

    h1 {
      color: #333;
      margin-bottom: 30px;
      text-align: center;
      font-size: 28px;
    }

    .form-group {
      margin-bottom: 20px;
    }

    label {
      display: block;
      margin-bottom: 8px;
      color: #555;
      font-weight: 600;
      font-size: 14px;
    }

    input[type="text"],
    input[type="number"],
    textarea {
      width: 100%;
      padding: 12px;
      border: 2px solid #e0e0e0;
      border-radius: 8px;
      font-size: 14px;
      transition: border-color 0.3s;
    }

    input:focus,
    textarea:focus {
      outline: none;
      border-color: #667eea;
    }

    textarea {
      resize: vertical;
      min-height: 80px;
      font-family: monospace;
    }

    .image-upload {
      border: 2px dashed #e0e0e0;
      border-radius: 8px;
      padding: 20px;
      text-align: center;
      cursor: pointer;
      transition: all 0.3s;
    }

    .image-upload:hover {
      border-color: #667eea;
      background: #f8f9ff;
    }

    .image-upload.has-image {
      border-style: solid;
      border-color: #4caf50;
    }

    .image-preview {
      max-width: 200px;
      max-height: 200px;
      margin: 10px auto;
      display: none;
    }

    .image-preview img {
      max-width: 100%;
      height: auto;
      border-radius: 8px;
    }

    .btn-group {
      display: flex;
      gap: 15px;
      margin-top: 30px;
    }

    .btn {
      flex: 1;
      padding: 14px 24px;
      border: none;
      border-radius: 8px;
      font-size: 15px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .btn-primary {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
    }

    .btn-primary:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
    }

    .btn-success {
      background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
      color: white;
    }

    .btn-success:hover {
      transform: translateY(-2px);
      box-shadow: 0 5px 15px rgba(17, 153, 142, 0.4);
    }

    .btn-secondary {
      background: #6c757d;
      color: white;
    }

    .btn-secondary:hover {
      background: #5a6268;
    }

    .btn:disabled {
      opacity: 0.6;
      cursor: not-allowed;
    }

    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.7);
      z-index: 1000;
      justify-content: center;
      align-items: center;
    }

    .modal.show {
      display: flex;
    }

    .modal-content {
      background: white;
      border-radius: 16px;
      padding: 30px;
      max-width: 600px;
      width: 90%;
      max-height: 80vh;
      overflow-y: auto;
    }

    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }

    .modal-header h2 {
      color: #333;
      font-size: 22px;
    }

    .close-btn {
      background: none;
      border: none;
      font-size: 28px;
      cursor: pointer;
      color: #999;
      line-height: 1;
    }

    .close-btn:hover {
      color: #333;
    }

    .tabs {
      display: flex;
      gap: 10px;
      margin-bottom: 20px;
      border-bottom: 2px solid #e0e0e0;
    }

    .attribute-tab {
      padding: 12px 24px;
      border: none;
      background: none;
      cursor: pointer;
      font-size: 14px;
      font-weight: 600;
      color: #666;
      border-bottom: 3px solid transparent;
      transition: all 0.3s;
    }

    .attribute-tab:hover {
      color: #667eea;
    }

    .attribute-tab.active {
      color: #667eea;
      border-bottom-color: #667eea;
    }

    .tab-content {
      display: none;
    }

    .tab-content.active {
      display: block;
    }

    select {
      width: 100%;
      padding: 12px;
      border: 2px solid #e0e0e0;
      border-radius: 8px;
      font-size: 14px;
      margin-bottom: 15px;
    }

    .chips-container {
      min-height: 60px;
      padding: 10px;
      background: #f8f9fa;
      border-radius: 8px;
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }

    .size-chip {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 8px 12px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border-radius: 20px;
      font-size: 13px;
      font-weight: 500;
    }

    .size-chip-remove {
      background: rgba(255, 255, 255, 0.3);
      border: none;
      color: white;
      width: 20px;
      height: 20px;
      border-radius: 50%;
      cursor: pointer;
      font-size: 16px;
      line-height: 1;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .size-chip-remove:hover {
      background: rgba(255, 255, 255, 0.5);
    }

    .notification {
      position: fixed;
      top: 20px;
      right: 20px;
      padding: 16px 24px;
      border-radius: 8px;
      color: white;
      font-weight: 500;
      z-index: 2000;
      animation: slideIn 0.3s ease-out;
      max-width: 400px;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
    }

    .notification.success {
      background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
    }

    .notification.error {
      background: linear-gradient(135deg, #eb3349 0%, #f45c43 100%);
    }

    .notification.warning {
      background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
    }

    .notification.info {
      background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
    }

    @keyframes slideIn {
      from {
        transform: translateX(400px);
        opacity: 0;
      }
      to {
        transform: translateX(0);
        opacity: 1;
      }
    }

    .result-box {
      margin-top: 20px;
      padding: 20px;
      background: #f8f9fa;
      border-radius: 8px;
      border-left: 4px solid #667eea;
    }

    .result-box h3 {
      color: #333;
      margin-bottom: 10px;
      font-size: 16px;
    }

    .result-box pre {
      background: #fff;
      padding: 15px;
      border-radius: 6px;
      overflow-x: auto;
      font-size: 12px;
      line-height: 1.5;
    }

    .loading {
      display: none;
      text-align: center;
      padding: 20px;
    }

    .loading.show {
      display: block;
    }

    .spinner {
      border: 4px solid #f3f3f3;
      border-top: 4px solid #667eea;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      animation: spin 1s linear infinite;
      margin: 0 auto;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>üõçÔ∏è Qu·∫£n L√Ω S·∫£n Ph·∫©m</h1>

    <div class="form-group">
      <label>M√£ S·∫£n Ph·∫©m *</label>
      <input type="text" id="defaultCode" placeholder="VD: NTEST" value="NTEST">
    </div>

    <div class="form-group">
      <label>T√™n S·∫£n Ph·∫©m *</label>
      <input type="text" id="productName" placeholder="Nh·∫≠p t√™n s·∫£n ph·∫©m">
    </div>

    <div class="form-group">
      <label>Gi√° B√°n (VNƒê) *</label>
      <input type="number" id="listPrice" value="200000" min="0">
    </div>

    <div class="form-group">
      <label>Gi√° Mua (VNƒê) *</label>
      <input type="number" id="purchasePrice" value="100000" min="0">
    </div>

    <div class="form-group">
      <label>S·ªë L∆∞·ª£ng *</label>
      <input type="number" id="qtyAvailable" value="1" min="0">
    </div>

    <div class="form-group">
      <label>H√¨nh ·∫¢nh</label>
      <div class="image-upload" id="imageUpload">
        <p>üì∑ Nh·∫•p ƒë·ªÉ ch·ªçn ·∫£nh ho·∫∑c d√°n ·∫£nh (Ctrl+V)</p>
        <div class="image-preview" id="imagePreview">
          <img id="previewImg" src="" alt="Preview">
        </div>
        <input type="file" id="fileInput" accept="image/*" style="display: none;">
      </div>
    </div>

    <div class="form-group">
      <label>Bi·∫øn Th·ªÉ (AttributeLines)</label>
      <button class="btn btn-secondary" onclick="openAttributeModal()">üìù Ch·ªçn Bi·∫øn Th·ªÉ</button>
      <textarea id="attributeLinesDisplay" data-field="AttributeLines" readonly style="margin-top: 10px;">[]</textarea>
    </div>

    <div class="btn-group">
      <button class="btn btn-primary" onclick="checkProduct()">1Ô∏è‚É£ Ki·ªÉm Tra S·∫£n Ph·∫©m</button>
      <button class="btn btn-success" id="createBtn" onclick="createProduct()" disabled>2Ô∏è‚É£ T·∫°o S·∫£n Ph·∫©m</button>
    </div>

    <div class="loading" id="loading">
      <div class="spinner"></div>
      <p style="margin-top: 10px; color: #666;">ƒêang x·ª≠ l√Ω...</p>
    </div>

    <div id="resultContainer"></div>
  </div>

  <div class="modal" id="attributeModal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Ch·ªçn Bi·∫øn Th·ªÉ</h2>
        <button class="close-btn" onclick="closeAttributeModal()">√ó</button>
      </div>

      <div class="tabs">
        <button class="attribute-tab active" onclick="switchTab('sizeText')">Size Ch·ªØ</button>
        <button class="attribute-tab" onclick="switchTab('color')">M√†u</button>
        <button class="attribute-tab" onclick="switchTab('sizeNumber')">Size S·ªë</button>
      </div>

      <div id="tab-sizeText" class="tab-content active">
        <label>Ch·ªçn Size Ch·ªØ</label>
        <select id="sizeTextSelect"></select>
        <div class="chips-container" id="sizeTextChips"></div>
      </div>

      <div id="tab-color" class="tab-content">
        <label>Ch·ªçn M√†u</label>
        <select id="colorSelect"></select>
        <div class="chips-container" id="colorChips"></div>
      </div>

      <div id="tab-sizeNumber" class="tab-content">
        <label>Ch·ªçn Size S·ªë</label>
        <select id="sizeNumberSelect"></select>
        <div class="chips-container" id="sizeNumberChips"></div>
      </div>

      <div class="btn-group">
        <button class="btn btn-success" onclick="saveAttributeLines()">‚úÖ L∆∞u</button>
        <button class="btn btn-secondary" onclick="closeAttributeModal()">‚ùå H·ªßy</button>
      </div>
    </div>
  </div>

  <script>
    const availableAttributes = {
      sizeText: {
        id: 1,
        name: "Size Ch·ªØ",
        code: "SZCh",
        values: [
          { Id: 31, Name: "XXL", Code: "xxl", Sequence: null },
          { Id: 32, Name: "XXXL", Code: "xxxl", Sequence: null },
          { Id: 5, Name: "Free Size", Code: "FS", Sequence: 0 },
          { Id: 1, Name: "S", Code: "S", Sequence: 1 },
          { Id: 2, Name: "M", Code: "M", Sequence: 2 },
          { Id: 3, Name: "L", Code: "L", Sequence: 3 },
          { Id: 4, Name: "XL", Code: "XL", Sequence: 4 },
        ],
      },
      color: {
        id: 3,
        name: "M√†u",
        code: "Mau",
        values: [
          { Id: 6, Name: "Tr·∫Øng", Code: "trang", Sequence: null },
          { Id: 7, Name: "ƒêen", Code: "den", Sequence: null },
          { Id: 8, Name: "ƒê·ªè", Code: "do", Sequence: null },
          { Id: 9, Name: "V√†ng", Code: "vang", Sequence: null },
          { Id: 10, Name: "Cam", Code: "cam", Sequence: null },
          { Id: 11, Name: "X√°m", Code: "xam", Sequence: null },
          { Id: 12, Name: "H·ªìng", Code: "hong", Sequence: null },
        ],
      },
      sizeNumber: {
        id: 4,
        name: "Size S·ªë",
        code: "SZNu",
        values: [
          { Id: 18, Name: "29", Code: "29", Sequence: null },
          { Id: 19, Name: "30", Code: "30", Sequence: null },
          { Id: 20, Name: "31", Code: "31", Sequence: null },
          { Id: 21, Name: "32", Code: "32", Sequence: null },
        ],
      },
    };

    let currentTab = "sizeText";
    let currentAttributeLines = [];
    let imageBase64 = null;

    const $ = (id) => document.getElementById(id);

    function show(element, isShow = true) {
      if (isShow) {
        element.classList.add('show');
      } else {
        element.classList.remove('show');
      }
    }

    function showNotification(message, type = 'info') {
      const notification = document.createElement('div');
      notification.className = `notification ${type}`;
      notification.textContent = message;
      document.body.appendChild(notification);

      setTimeout(() => {
        notification.remove();
      }, 3000);
    }

    function showLoading(isShow = true) {
      show($('loading'), isShow);
    }

    function displayResult(title, data) {
      const resultContainer = $('resultContainer');
      resultContainer.innerHTML = `
        <div class="result-box">
          <h3>${title}</h3>
          <pre>${JSON.stringify(data, null, 2)}</pre>
        </div>
      `;
    }

    $('defaultCode').addEventListener('input', (e) => {
      e.target.value = e.target.value.toUpperCase();
    });

    $('imageUpload').addEventListener('click', () => {
      $('fileInput').click();
    });

    $('fileInput').addEventListener('change', (e) => {
      const file = e.target.files[0];
      if (file) {
        handleImageFile(file);
      }
    });

    document.addEventListener('paste', (e) => {
      const items = e.clipboardData.items;
      for (let item of items) {
        if (item.type.indexOf('image') !== -1) {
          const file = item.getAsFile();
          handleImageFile(file);
        }
      }
    });

    function handleImageFile(file) {
      const reader = new FileReader();
      reader.onload = (e) => {
        imageBase64 = e.target.result;
        $('previewImg').src = imageBase64;
        $('imagePreview').style.display = 'block';
        $('imageUpload').classList.add('has-image');
        showNotification('ƒê√£ t·∫£i ·∫£nh th√†nh c√¥ng!', 'success');
      };
      reader.readAsDataURL(file);
    }

    window.switchTab = (tabName) => {
      currentTab = tabName;

      document.querySelectorAll('.attribute-tab').forEach((btn) => {
        btn.classList.remove('active');
      });
      event.target.classList.add('active');

      document.querySelectorAll('.tab-content').forEach((content) => {
        content.classList.remove('active');
      });
      $(`tab-${tabName}`).classList.add('active');
    };

    window.openAttributeModal = () => {
      const textarea = $('attributeLinesDisplay');
      if (textarea) {
        try {
          currentAttributeLines = JSON.parse(textarea.value);
        } catch (e) {
          currentAttributeLines = [];
        }
      }

      populateSelect('sizeTextSelect', availableAttributes.sizeText.values);
      populateSelect('colorSelect', availableAttributes.color.values);
      populateSelect('sizeNumberSelect', availableAttributes.sizeNumber.values);

      renderChips('sizeText');
      renderChips('color');
      renderChips('sizeNumber');

      show($('attributeModal'));
    };

    const populateSelect = (selectId, values) => {
      const select = $(selectId);
      select.innerHTML = '<option value="">-- Ch·ªçn --</option>';
      values.forEach((item) => {
        select.innerHTML += `<option value="${item.Id}">${item.Name}</option>`;
      });
    };

    window.closeAttributeModal = () => {
      show($('attributeModal'), false);
    };

    const getAttributeLineByType = (type) => {
      const attrConfig = availableAttributes[type];
      return currentAttributeLines.find(
        (line) => line.AttributeId === attrConfig.id
      );
    };

    const renderChips = (type) => {
      const attrConfig = availableAttributes[type];
      const chipsContainer = $(`${type}Chips`);
      chipsContainer.innerHTML = '';

      const attrLine = getAttributeLineByType(type);

      if (!attrLine || !attrLine.Values || attrLine.Values.length === 0) {
        chipsContainer.innerHTML =
          '<p style="color: #999; font-size: 13px; margin-top: 10px;">Ch∆∞a c√≥ gi√° tr·ªã n√†o</p>';
        return;
      }

      attrLine.Values.forEach((val) => {
        const chip = document.createElement('div');
        chip.className = 'size-chip';
        chip.innerHTML = `
          <span>${val.Name}</span>
          <button class="size-chip-remove" onclick="removeValue('${type}', ${val.Id})">√ó</button>
        `;
        chipsContainer.appendChild(chip);
      });
    };

    ['sizeText', 'color', 'sizeNumber'].forEach((type) => {
      const selectId = `${type}Select`;
      const select = $(selectId);

      if (select) {
        select.addEventListener('change', (e) => {
          const valueId = parseInt(e.target.value);
          if (!valueId) return;

          const attrConfig = availableAttributes[type];
          const selectedValue = attrConfig.values.find(
            (v) => v.Id === valueId
          );
          if (!selectedValue) return;

          if (!currentAttributeLines) {
            currentAttributeLines = [];
          }

          let attrLine = getAttributeLineByType(type);

          if (!attrLine) {
            attrLine = {
              Attribute: {
                Id: attrConfig.id,
                Name: attrConfig.name,
                Code: attrConfig.code,
                Sequence: type === 'sizeText' ? 1 : null,
                CreateVariant: true,
              },
              Values: [],
              AttributeId: attrConfig.id,
            };
            currentAttributeLines.push(attrLine);
          }

          if (!attrLine.Values || !Array.isArray(attrLine.Values)) {
            attrLine.Values = [];
          }

          const existingValue = attrLine.Values.find((v) => v.Id === valueId);
          if (existingValue) {
            showNotification('Gi√° tr·ªã n√†y ƒë√£ ƒë∆∞·ª£c th√™m r·ªìi!', 'warning');
            e.target.value = '';
            return;
          }

          attrLine.Values.push({
            Id: selectedValue.Id,
            Name: selectedValue.Name,
            Code: selectedValue.Code,
            Sequence: selectedValue.Sequence,
            AttributeId: attrConfig.id,
            AttributeName: attrConfig.name,
            PriceExtra: null,
            NameGet: `${attrConfig.name}: ${selectedValue.Name}`,
            DateCreated: null,
          });

          renderChips(type);
          e.target.value = '';
        });
      }
    });

    window.removeValue = (type, valueId) => {
      const attrLine = getAttributeLineByType(type);
      if (!attrLine) return;

      attrLine.Values = attrLine.Values.filter((v) => v.Id !== valueId);

      if (attrLine.Values.length === 0) {
        currentAttributeLines = currentAttributeLines.filter(
          (line) => line.AttributeId !== attrLine.AttributeId
        );
      }

      renderChips(type);
    };

    window.saveAttributeLines = () => {
      const textarea = $('attributeLinesDisplay');
      if (textarea) {
        textarea.value = JSON.stringify(currentAttributeLines, null, 2);
      }

      closeAttributeModal();
      showNotification('ƒê√£ l∆∞u thay ƒë·ªïi AttributeLines!', 'success');
    };

    async function checkProduct() {
      const defaultCode = $('defaultCode').value.trim().toUpperCase();
      
      if (!defaultCode) {
        showNotification('Vui l√≤ng nh·∫≠p m√£ s·∫£n ph·∫©m!', 'error');
        return;
      }

      showLoading(true);

      try {
        const response = await fetch(
          `https://tomato.tpos.vn/odata/ProductTemplate/OdataService.GetViewV2?Active=true&DefaultCode=${defaultCode}`
        );

        const data = await response.json();

        showLoading(false);

        if (data.value && data.value.length > 0) {
          showNotification('‚ö†Ô∏è S·∫£n ph·∫©m ƒë√£ t·ªìn t·∫°i!', 'warning');
          displayResult('K·∫øt Qu·∫£ Ki·ªÉm Tra - S·∫£n ph·∫©m ƒë√£ t·ªìn t·∫°i', data.value[0]);
          $('createBtn').disabled = true;
        } else {
          showNotification('‚úÖ S·∫£n ph·∫©m ch∆∞a t·ªìn t·∫°i, c√≥ th·ªÉ t·∫°o m·ªõi!', 'success');
          displayResult('K·∫øt Qu·∫£ Ki·ªÉm Tra - C√≥ th·ªÉ t·∫°o s·∫£n ph·∫©m m·ªõi', { message: 'S·∫£n ph·∫©m ch∆∞a t·ªìn t·∫°i trong h·ªá th·ªëng' });
          $('createBtn').disabled = false;
        }
      } catch (error) {
        showLoading(false);
        showNotification('‚ùå L·ªói khi ki·ªÉm tra: ' + error.message, 'error');
        console.error(error);
      }
    }

    async function createProduct() {
      const defaultCode = $('defaultCode').value.trim().toUpperCase();
      const productName = $('productName').value.trim();
      const listPrice = parseFloat($('listPrice').value);
      const purchasePrice = parseFloat($('purchasePrice').value);
      const qtyAvailable = parseFloat($('qtyAvailable').value);

      if (!defaultCode || !productName) {
        showNotification('Vui l√≤ng nh·∫≠p ƒë·∫ßy ƒë·ªß th√¥ng tin b·∫Øt bu·ªôc!', 'error');
        return;
      }

      const attributeLines = JSON.parse($('attributeLinesDisplay').value);

      const payload = {
        Id: 0,
        Name: productName,
        NameNoSign: null,
        Description: null,
        Type: "product",
        ShowType: "C√≥ th·ªÉ l∆∞u tr·ªØ",
        ListPrice: listPrice,
        DiscountSale: 0,
        DiscountPurchase: 0,
        PurchasePrice: purchasePrice,
        StandardPrice: 0,
        SaleOK: true,
        PurchaseOK: true,
        Active: true,
        UOMId: 1,
        UOMName: null,
        UOMPOId: 1,
        UOMPOName: null,
        UOSId: null,
        IsProductVariant: false,
        EAN13: null,
        DefaultCode: defaultCode,
        QtyAvailable: qtyAvailable,
        VirtualAvailable: 0,
        OutgoingQty: 0,
        IncomingQty: 0,
        PropertyCostMethod: null,
        CategId: 2,
        CategCompleteName: null,
        CategName: null,
        Weight: 0,
        Tracking: "none",
        DescriptionPurchase: null,
        DescriptionSale: null,
        CompanyId: 1,
        NameGet: null,
        PropertyStockProductionId: null,
        SaleDelay: 0,
        InvoicePolicy: "order",
        PurchaseMethod: "receive",
        PropertyValuation: null,
        Valuation: null,
        AvailableInPOS: true,
        POSCategId: null,
        CostMethod: null,
        Barcode: null,
        Image: imageBase64,
        ImageUrl: null,
        Thumbnails: [],
        ProductVariantCount: 0,
        LastUpdated: null,
        UOMCategId: null,
        BOMCount: 0,
        Volume: null,
        CategNameNoSign: null,
        UOMNameNoSign: null,
        UOMPONameNoSign: null,
        IsCombo: false,
        EnableAll: false,
        ComboPurchased: null,
        TaxAmount: null,
        Version: 0,
        VariantFirstId: null,
        VariantFistId: null,
        ZaloProductId: null,
        CompanyName: null,
        CompanyNameNoSign: null,
        DateCreated: null,
        InitInventory: 0,
        UOMViewId: null,
        ImporterId: null,
        ImporterName: null,
        ImporterAddress: null,
        ProducerId: null,
        ProducerName: null,
        ProducerAddress: null,
        DistributorId: null,
        DistributorName: null,
        DistributorAddress: null,
        OriginCountryId: null,
        OriginCountryName: null,
        InfoWarning: null,
        Element: null,
        YearOfManufacture: null,
        Specifications: null,
        Tags: null,
        CreatedByName: null,
        OrderTag: null,
        StringExtraProperties: null,
        CreatedById: null,
        Error: null,
        UOM: {
          Id: 1,
          Name: "C√°i",
          NameNoSign: null,
          Rounding: 0.001,
          Active: true,
          Factor: 1,
          FactorInv: 1,
          UOMType: "reference",
          CategoryId: 1,
          CategoryName: "ƒê∆°n v·ªã",
          Description: null,
          ShowUOMType: "ƒê∆°n v·ªã g·ªëc c·ªßa nh√≥m n√†y",
          NameGet: "C√°i",
          ShowFactor: 1,
          DateCreated: "2018-05-25T15:44:44.14+07:00"
        },
        Categ: {
          Id: 2,
          Name: "C√≥ th·ªÉ b√°n",
          CompleteName: "C√≥ th·ªÉ b√°n",
          ParentId: null,
          ParentCompleteName: null,
          ParentLeft: 0,
          ParentRight: 1,
          Sequence: null,
          Type: "normal",
          AccountIncomeCategId: null,
          AccountExpenseCategId: null,
          StockJournalId: null,
          StockAccountInputCategId: null,
          StockAccountOutputCategId: null,
          StockValuationAccountId: null,
          PropertyValuation: null,
          PropertyCostMethod: "average",
          NameNoSign: "Co the ban",
          IsPos: true,
          Version: null,
          IsDelete: false
        },
        UOMPO: {
          Id: 1,
          Name: "C√°i",
          NameNoSign: null,
          Rounding: 0.001,
          Active: true,
          Factor: 1,
          FactorInv: 1,
          UOMType: "reference",
          CategoryId: 1,
          CategoryName: "ƒê∆°n v·ªã",
          Description: null,
          ShowUOMType: "ƒê∆°n v·ªã g·ªëc c·ªßa nh√≥m n√†y",
          NameGet: "C√°i",
          ShowFactor: 1,
          DateCreated: "2018-05-25T15:44:44.14+07:00"
        },
        AttributeLines: attributeLines,
        Items: [],
        UOMLines: [],
        ComboProducts: [],
        ProductSupplierInfos: []
      };

      showLoading(true);

      try {
        const response = await fetch(
          'https://tomato.tpos.vn/odata/ProductTemplate/ODataService.InsertV2?$expand=ProductVariants,UOM,UOMPO',
          {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
            },
            body: JSON.stringify(payload)
          }
        );

        const data = await response.json();

        showLoading(false);

        if (response.ok) {
          showNotification('üéâ T·∫°o s·∫£n ph·∫©m th√†nh c√¥ng!', 'success');
          displayResult('K·∫øt Qu·∫£ T·∫°o S·∫£n Ph·∫©m - Th√†nh c√¥ng', data);
          $('createBtn').disabled = true;
        } else {
          showNotification('‚ùå L·ªói khi t·∫°o s·∫£n ph·∫©m!', 'error');
          displayResult('K·∫øt Qu·∫£ T·∫°o S·∫£n Ph·∫©m - L·ªói', data);
        }
      } catch (error) {
        showLoading(false);
        showNotification('‚ùå L·ªói khi t·∫°o s·∫£n ph·∫©m: ' + error.message, 'error');
        console.error(error);
      }
    }
  </script>
</body>
</html>
