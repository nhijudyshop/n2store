<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üèÅ ƒêua Thua - X·∫øp H·∫°ng Ng·∫´u Nhi√™n</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 50%, #7e22ce 100%);
            min-height: 100vh;
            padding: 20px;
            overflow-x: hidden;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
            padding-top: 20px;
        }

        .header h1 {
            font-size: 3.5rem;
            color: white;
            text-shadow: 3px 3px 6px rgba(0,0,0,0.3);
            margin-bottom: 10px;
            animation: glow 2s ease-in-out infinite;
        }

        @keyframes glow {
            0%, 100% { text-shadow: 0 0 20px #fff, 0 0 30px #fff, 0 0 40px #ff00de; }
            50% { text-shadow: 0 0 10px #fff, 0 0 20px #fff, 0 0 30px #ff00de; }
        }

        .header p {
            font-size: 1.3rem;
            color: white;
            opacity: 0.95;
        }

        .main-grid {
            display: grid;
            grid-template-columns: 350px 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }

        @media (max-width: 1024px) {
            .main-grid {
                grid-template-columns: 1fr;
            }
        }

        .card {
            background: white;
            border-radius: 20px;
            padding: 25px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        }

        .card-title {
            font-size: 1.4rem;
            font-weight: bold;
            color: #333;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        /* Left Panel - Controls */
        .add-form {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        .name-input {
            flex: 1;
            padding: 12px;
            font-size: 1rem;
            border: 2px solid #60a5fa;
            border-radius: 10px;
        }

        .name-input:focus {
            outline: none;
            border-color: #3b82f6;
        }

        .add-btn {
            padding: 12px 20px;
            font-size: 1rem;
            font-weight: bold;
            color: white;
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .add-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(59, 130, 246, 0.4);
        }

        .participants-list {
            max-height: 250px;
            overflow-y: auto;
            margin-bottom: 15px;
        }

        .participant-item {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 12px;
            margin-bottom: 8px;
            background: linear-gradient(135deg, #dbeafe 0%, #e9d5ff 100%);
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .participant-item:hover {
            transform: translateX(5px);
        }

        .participant-name {
            font-weight: 600;
            color: #333;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .participant-icon {
            font-size: 1.5rem;
        }

        .remove-btn {
            padding: 6px 12px;
            background: #ef4444;
            color: white;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: bold;
        }

        .remove-btn:hover {
            background: #dc2626;
        }

        .race-btn {
            width: 100%;
            padding: 18px;
            font-size: 1.4rem;
            font-weight: bold;
            color: white;
            background: linear-gradient(135deg, #f59e0b 0%, #dc2626 100%);
            border: none;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 5px 20px rgba(245, 158, 11, 0.4);
            margin-top: 15px;
        }

        .race-btn:hover:not(:disabled) {
            transform: scale(1.05);
            box-shadow: 0 8px 30px rgba(245, 158, 11, 0.6);
        }

        .race-btn:disabled {
            background: #9ca3af;
            cursor: not-allowed;
            box-shadow: none;
        }

        /* Racing Track */
        .race-container {
            background: linear-gradient(to bottom, #1e293b 0%, #334155 100%);
            border-radius: 20px;
            padding: 30px;
            min-height: 600px;
            position: relative;
            overflow: hidden;
        }

        .race-track {
            position: relative;
            margin-top: 20px;
        }

        .track-line {
            position: relative;
            height: 70px;
            margin-bottom: 15px;
            background: linear-gradient(90deg, 
                rgba(255,255,255,0.1) 0%, 
                rgba(255,255,255,0.05) 50%, 
                rgba(255,255,255,0.1) 100%);
            border-radius: 10px;
            overflow: hidden;
            border: 2px solid rgba(255,255,255,0.2);
        }

        .track-line::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 2px;
            background: repeating-linear-gradient(
                90deg,
                white 0px,
                white 20px,
                transparent 20px,
                transparent 40px
            );
            opacity: 0.3;
        }

        .finish-line {
            position: absolute;
            right: 0;
            top: 0;
            bottom: 0;
            width: 40px;
            background: repeating-linear-gradient(
                45deg,
                #000,
                #000 10px,
                #fff 10px,
                #fff 20px
            );
            opacity: 0.7;
        }

        .racer {
            position: absolute;
            left: 0;
            top: 50%;
            transform: translateY(-50%);
            display: flex;
            align-items: center;
            gap: 10px;
            transition: left 0.1s linear;
            z-index: 10;
        }

        .racer-icon {
            font-size: 2.5rem;
            filter: drop-shadow(2px 2px 4px rgba(0,0,0,0.5));
            animation: bounce 0.5s infinite;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-5px); }
        }

        .racer-name {
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 1rem;
            white-space: nowrap;
            border: 2px solid rgba(255,255,255,0.3);
        }

        /* Results */
        .results-container {
            display: none;
            margin-top: 30px;
            padding: 30px;
            background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
            border-radius: 20px;
            animation: slideDown 0.5s ease;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .results-container.show {
            display: block;
        }

        .results-title {
            font-size: 2rem;
            font-weight: bold;
            color: white;
            text-align: center;
            margin-bottom: 25px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .podium {
            display: flex;
            justify-content: center;
            align-items: flex-end;
            gap: 20px;
            margin-bottom: 30px;
        }

        .podium-place {
            text-align: center;
            animation: popUp 0.6s ease backwards;
        }

        .podium-place.first {
            animation-delay: 0.3s;
        }

        .podium-place.second {
            animation-delay: 0.1s;
        }

        .podium-place.third {
            animation-delay: 0.2s;
        }

        @keyframes popUp {
            from {
                opacity: 0;
                transform: scale(0);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        .podium-box {
            width: 150px;
            background: linear-gradient(to top, rgba(0,0,0,0.3), transparent);
            border-radius: 10px 10px 0 0;
            padding: 20px 10px;
            position: relative;
        }

        .podium-box.first {
            height: 180px;
            background: linear-gradient(to top, #fbbf24, #fcd34d);
            border: 3px solid #fff;
        }

        .podium-box.second {
            height: 140px;
            background: linear-gradient(to top, #94a3b8, #cbd5e1);
            border: 3px solid #fff;
        }

        .podium-box.third {
            height: 110px;
            background: linear-gradient(to top, #d97706, #f59e0b);
            border: 3px solid #fff;
        }

        .podium-medal {
            font-size: 3rem;
            margin-bottom: 10px;
        }

        .podium-rank {
            font-size: 1.5rem;
            font-weight: bold;
            color: white;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }

        .podium-name {
            font-size: 1.1rem;
            font-weight: bold;
            color: white;
            margin-top: 5px;
            word-wrap: break-word;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
        }

        .ranking-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 15px;
        }

        .ranking-item {
            background: white;
            padding: 15px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            gap: 15px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            animation: fadeIn 0.5s ease backwards;
        }

        .ranking-item:nth-child(n+4) {
            animation-delay: calc(0.1s * (var(--index) - 3));
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateX(-20px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        .ranking-number {
            font-size: 2rem;
            font-weight: bold;
            color: #6366f1;
            min-width: 50px;
            text-align: center;
        }

        .ranking-name {
            font-size: 1.1rem;
            font-weight: 600;
            color: #333;
        }

        .countdown {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 15rem;
            font-weight: bold;
            color: rgba(255,255,255,0.9);
            text-shadow: 0 0 40px rgba(255,255,255,0.8);
            animation: countdownPulse 1s ease;
            z-index: 100;
        }

        @keyframes countdownPulse {
            0% {
                transform: translate(-50%, -50%) scale(0);
                opacity: 0;
            }
            50% {
                transform: translate(-50%, -50%) scale(1.2);
            }
            100% {
                transform: translate(-50%, -50%) scale(1);
                opacity: 1;
            }
        }

        .status-text {
            text-align: center;
            font-size: 1.8rem;
            color: white;
            font-weight: bold;
            margin-top: 20px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }

        /* Fireworks */
        .firework {
            position: fixed;
            width: 4px;
            height: 4px;
            border-radius: 50%;
            animation: firework 1s ease-out;
            z-index: 1000;
        }

        @keyframes firework {
            0% {
                transform: translate(0, 0);
                opacity: 1;
            }
            100% {
                transform: translate(var(--tx), var(--ty));
                opacity: 0;
            }
        }

        .participants-list::-webkit-scrollbar {
            width: 6px;
        }

        .participants-list::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }

        .participants-list::-webkit-scrollbar-thumb {
            background: #8b5cf6;
            border-radius: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>üèÅ ƒêUA THUA - X·∫æP H·∫†NG NG·∫™U NHI√äN üèÜ</h1>
            <p>Ai s·∫Ω l√† ng∆∞·ªùi v·ªÅ ƒë√≠ch ƒë·∫ßu ti√™n?</p>
        </div>

        <!-- Main Grid -->
        <div class="main-grid">
            <!-- Left Panel - Controls -->
            <div>
                <div class="card">
                    <div class="card-title">
                        üë• Ng∆∞·ªùi Tham Gia
                    </div>
                    <form class="add-form" onsubmit="addParticipant(event)">
                        <input type="text" id="nameInput" class="name-input" placeholder="Nh·∫≠p t√™n...">
                        <button type="submit" class="add-btn">‚ûï Th√™m</button>
                    </form>
                    <div class="participants-list" id="participantsList"></div>
                    <div style="text-align: center; color: #666; font-size: 0.9rem; margin: 10px 0;">
                        T·ªïng: <strong style="color: #3b82f6; font-size: 1.1rem;" id="participantCount">5</strong> ng∆∞·ªùi
                    </div>
                    <button id="raceBtn" class="race-btn" onclick="startRace()">
                        üèÅ B·∫ÆT ƒê·∫¶U ƒêUA
                    </button>
                </div>
            </div>

            <!-- Right Panel - Racing Track -->
            <div class="card race-container">
                <div class="card-title" style="color: white;">
                    üèÅ ƒê∆∞·ªùng ƒêua
                </div>
                <div id="statusText" class="status-text">S·∫µn s√†ng ƒëua!</div>
                <div id="raceTrack" class="race-track"></div>
                <div id="resultsContainer" class="results-container"></div>
            </div>
        </div>
    </div>

    <script>
        let participants = [
            'Nguy·ªÖn VƒÉn A',
            'Tr·∫ßn Th·ªã B',
            'L√™ VƒÉn C',
            'Ph·∫°m Th·ªã D',
            'Ho√†ng VƒÉn E'
        ];
        let isRacing = false;
        let racers = [];
        let participantIcons = {}; // Store icon for each participant

        // Nhi·ªÅu bi·ªÉu t∆∞·ª£ng ƒë·ªông v·∫≠t ƒë·ªÉ ƒëua
        const animalIcons = [
            'üêÜ', 'ü¶Å', 'üêé', 'ü¶Ö', 'üêï', 'ü¶ò', 'üêÖ', 'üêÉ', 'üêÇ', 'üêÑ',
            'ü¶å', 'ü¶í', 'ü¶è', 'ü¶õ', 'üêò', 'ü¶ô', 'ü¶¨', 'üê™', 'üê´', 'ü¶ì',
            'üêñ', 'üêó', 'üêè', 'üêë', 'üêê', 'ü¶¶', 'ü¶®', 'ü¶°', 'üêª', 'üêº',
            'üê®', 'üêØ', 'ü¶ä', 'üê∫', 'üê∂', 'üê±', 'üê≠', 'üêπ', 'üê∞', 'ü¶ù',
            'üêøÔ∏è', 'ü¶î', 'ü¶á', 'ü¶à', 'üêä', 'ü¶ñ', 'ü¶ï', 'üêâ', 'üê≤', 'ü¶é'
        ];

        // Initialize
        assignIconsToParticipants();
        updateParticipantsList();

        function assignIconsToParticipants() {
            participants.forEach((name, index) => {
                if (!participantIcons[name]) {
                    participantIcons[name] = animalIcons[index % animalIcons.length];
                }
            });
        }

        function getRandomIcon() {
            return animalIcons[Math.floor(Math.random() * animalIcons.length)];
        }

        function addParticipant(event) {
            event.preventDefault();
            const nameInput = document.getElementById('nameInput');
            const name = nameInput.value.trim();
            
            if (name && !participants.includes(name)) {
                participants.push(name);
                participantIcons[name] = getRandomIcon();
                nameInput.value = '';
                updateParticipantsList();
            }
        }

        function removeParticipant(name) {
            participants = participants.filter(p => p !== name);
            delete participantIcons[name];
            updateParticipantsList();
        }

        function updateParticipantsList() {
            const listDiv = document.getElementById('participantsList');
            const countSpan = document.getElementById('participantCount');
            
            countSpan.textContent = participants.length;
            
            if (participants.length === 0) {
                listDiv.innerHTML = '<div style="text-align: center; padding: 30px; color: #9ca3af;">Ch∆∞a c√≥ ng∆∞·ªùi tham gia</div>';
            } else {
                listDiv.innerHTML = participants.map((name, index) => `
                    <div class="participant-item">
                        <span class="participant-name">
                            <span class="participant-icon">${participantIcons[name]}</span>
                            <span>${index + 1}. ${name}</span>
                        </span>
                        <button class="remove-btn" onclick="removeParticipant('${name}')">‚úï</button>
                    </div>
                `).join('');
            }
        }

        async function startRace() {
            if (participants.length < 2) {
                alert('C·∫ßn √≠t nh·∫•t 2 ng∆∞·ªùi ƒë·ªÉ ƒëua!');
                return;
            }

            if (isRacing) return;
            isRacing = true;

            const raceBtn = document.getElementById('raceBtn');
            const statusText = document.getElementById('statusText');
            const resultsContainer = document.getElementById('resultsContainer');
            
            raceBtn.disabled = true;
            resultsContainer.classList.remove('show');
            resultsContainer.innerHTML = '';

            // Setup race track
            setupRaceTrack();

            // Countdown
            for (let i = 3; i > 0; i--) {
                statusText.textContent = `ƒê·∫øm ng∆∞·ª£c: ${i}...`;
                await showCountdown(i);
                await sleep(1000);
            }

            statusText.textContent = 'XU·∫§T PH√ÅT! üèÅ';
            
            // Race!
            const results = await runRace();
            
            // Show results
            await sleep(500);
            displayResults(results);
            createFireworks();

            raceBtn.disabled = false;
            isRacing = false;
        }

        function setupRaceTrack() {
            const trackDiv = document.getElementById('raceTrack');
            trackDiv.innerHTML = '';
            racers = [];

            participants.forEach((name, index) => {
                const trackLine = document.createElement('div');
                trackLine.className = 'track-line';
                trackLine.innerHTML = '<div class="finish-line"></div>';

                const racer = document.createElement('div');
                racer.className = 'racer';
                racer.innerHTML = `
                    <span class="racer-icon">${participantIcons[name]}</span>
                    <span class="racer-name">${name}</span>
                `;
                
                trackLine.appendChild(racer);
                trackDiv.appendChild(trackLine);

                racers.push({
                    name: name,
                    icon: participantIcons[name],
                    element: racer,
                    position: 0,
                    speed: 0,
                    finished: false,
                    finishTime: 0
                });
            });
        }

        async function runRace() {
            const trackWidth = document.querySelector('.track-line').offsetWidth - 200;
            const finishLine = trackWidth;
            let raceTime = 0;
            const results = [];

            // Assign random speeds
            racers.forEach(racer => {
                racer.speed = 2 + Math.random() * 3; // Random speed between 2-5
            });

            return new Promise((resolve) => {
                const raceInterval = setInterval(() => {
                    raceTime += 50;
                    let allFinished = true;

                    racers.forEach(racer => {
                        if (!racer.finished) {
                            allFinished = false;
                            // Add some randomness to movement
                            racer.position += racer.speed + (Math.random() - 0.5);
                            
                            if (racer.position >= finishLine) {
                                racer.position = finishLine;
                                racer.finished = true;
                                racer.finishTime = raceTime;
                                results.push({
                                    name: racer.name,
                                    time: raceTime,
                                    rank: results.length + 1
                                });
                            }

                            racer.element.style.left = racer.position + 'px';
                        }
                    });

                    if (allFinished) {
                        clearInterval(raceInterval);
                        resolve(results);
                    }
                }, 50);
            });
        }

        function displayResults(results) {
            const container = document.getElementById('resultsContainer');
            const statusText = document.getElementById('statusText');
            
            statusText.textContent = 'Ho√†n th√†nh! üéâ';
            
            let html = '<div class="results-title">üèÜ K·∫æT QU·∫¢ CU·ªòC ƒêUA üèÜ</div>';
            
            // Podium (Top 3)
            if (results.length >= 3) {
                html += '<div class="podium">';
                html += `
                    <div class="podium-place second">
                        <div class="podium-box second">
                            <div class="podium-medal">ü•à</div>
                            <div style="font-size: 2.5rem; margin: 10px 0;">${participantIcons[results[1].name]}</div>
                            <div class="podium-rank">H·∫°ng 2</div>
                            <div class="podium-name">${results[1].name}</div>
                        </div>
                    </div>
                    <div class="podium-place first">
                        <div class="podium-box first">
                            <div class="podium-medal">ü•á</div>
                            <div style="font-size: 3rem; margin: 10px 0;">${participantIcons[results[0].name]}</div>
                            <div class="podium-rank">H·∫°ng 1</div>
                            <div class="podium-name">${results[0].name}</div>
                        </div>
                    </div>
                    <div class="podium-place third">
                        <div class="podium-box third">
                            <div class="podium-medal">ü•â</div>
                            <div style="font-size: 2.5rem; margin: 10px 0;">${participantIcons[results[2].name]}</div>
                            <div class="podium-rank">H·∫°ng 3</div>
                            <div class="podium-name">${results[2].name}</div>
                        </div>
                    </div>
                `;
                html += '</div>';
            } else if (results.length === 2) {
                html += '<div class="podium">';
                html += `
                    <div class="podium-place first">
                        <div class="podium-box first">
                            <div class="podium-medal">ü•á</div>
                            <div style="font-size: 3rem; margin: 10px 0;">${participantIcons[results[0].name]}</div>
                            <div class="podium-rank">H·∫°ng 1</div>
                            <div class="podium-name">${results[0].name}</div>
                        </div>
                    </div>
                    <div class="podium-place second">
                        <div class="podium-box second">
                            <div class="podium-medal">ü•à</div>
                            <div style="font-size: 2.5rem; margin: 10px 0;">${participantIcons[results[1].name]}</div>
                            <div class="podium-rank">H·∫°ng 2</div>
                            <div class="podium-name">${results[1].name}</div>
                        </div>
                    </div>
                `;
                html += '</div>';
            } else if (results.length === 1) {
                html += '<div class="podium">';
                html += `
                    <div class="podium-place first">
                        <div class="podium-box first">
                            <div class="podium-medal">ü•á</div>
                            <div style="font-size: 3rem; margin: 10px 0;">${participantIcons[results[0].name]}</div>
                            <div class="podium-rank">H·∫°ng 1</div>
                            <div class="podium-name">${results[0].name}</div>
                        </div>
                    </div>
                `;
                html += '</div>';
            }

            // Full ranking
            if (results.length > 3) {
                html += '<div class="ranking-list">';
                results.slice(3).forEach((result, index) => {
                    html += `
                        <div class="ranking-item" style="--index: ${index + 4}">
                            <div class="ranking-number">#${result.rank}</div>
                            <div style="display: flex; align-items: center; gap: 10px;">
                                <span style="font-size: 1.8rem;">${participantIcons[result.name]}</span>
                                <div class="ranking-name">${result.name}</div>
                            </div>
                        </div>
                    `;
                });
                html += '</div>';
            }

            container.innerHTML = html;
            container.classList.add('show');
        }

        function showCountdown(number) {
            return new Promise((resolve) => {
                const countdown = document.createElement('div');
                countdown.className = 'countdown';
                countdown.textContent = number;
                document.querySelector('.race-container').appendChild(countdown);
                
                setTimeout(() => {
                    countdown.remove();
                    resolve();
                }, 1000);
            });
        }

        function createFireworks() {
            const colors = ['#ff6b6b', '#4ecdc4', '#45b7d1', '#f7dc6f', '#bb8fce', '#ff6b9d'];
            
            for (let i = 0; i < 30; i++) {
                setTimeout(() => {
                    const x = Math.random() * window.innerWidth;
                    const y = Math.random() * window.innerHeight * 0.5;
                    
                    for (let j = 0; j < 20; j++) {
                        const firework = document.createElement('div');
                        firework.className = 'firework';
                        firework.style.left = x + 'px';
                        firework.style.top = y + 'px';
                        firework.style.background = colors[Math.floor(Math.random() * colors.length)];
                        
                        const angle = (Math.PI * 2 * j) / 20;
                        const velocity = 50 + Math.random() * 100;
                        firework.style.setProperty('--tx', Math.cos(angle) * velocity + 'px');
                        firework.style.setProperty('--ty', Math.sin(angle) * velocity + 'px');
                        
                        document.body.appendChild(firework);
                        
                        setTimeout(() => firework.remove(), 1000);
                    }
                }, i * 300);
            }
        }

        function sleep(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }
    </script>
</body>
</html>