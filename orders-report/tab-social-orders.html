<!--
  üìñ TAB SOCIAL ORDERS
  Qu·∫£n l√Ω ƒë∆°n h√†ng nh√°p t·ª´ c√°c k√™nh m·∫°ng x√£ h·ªôi (kh√¥ng qua TPOS)
  Design: orders-report/docs/plans/2026-01-24-tab-social-orders-design.md
-->
<!doctype html>
<html lang="vi">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>ƒê∆°n Social - N2Store</title>
        <link
            href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
            rel="stylesheet"
        />
        <link
            rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
        />
        <!-- Reuse styles from tab1 -->
        <link rel="stylesheet" href="css/tab1-orders.css" />
        <!-- Custom styles for social tab -->
        <link rel="stylesheet" href="css/tab-social-orders.css" />
    </head>

    <body>
        <!-- Loading Overlay -->
        <div class="loading-overlay" id="loadingOverlay" style="display: none">
            <div style="background: white; padding: 32px; border-radius: 12px; text-align: center">
                <div class="loading-spinner" style="margin: 0 auto 16px"></div>
                <div class="loading-text" style="font-size: 14px; color: #6b7280">
                    ƒêang t·∫£i d·ªØ li·ªáu...
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Header Section -->
            <div class="social-header">
                <div class="social-header-left">
                    <h1 class="social-title">
                        <i class="fas fa-share-nodes"></i>
                        ƒê∆°n Social
                    </h1>
                    <span class="social-subtitle">Qu·∫£n l√Ω ƒë∆°n h√†ng t·ª´ c√°c k√™nh m·∫°ng x√£ h·ªôi</span>
                </div>
                <div class="social-header-actions">
                    <button class="btn-primary btn-create-order" onclick="openCreateOrderModal()">
                        <i class="fas fa-plus"></i>
                        T·∫°o ƒë∆°n m·ªõi
                    </button>
                    <button
                        class="btn-primary"
                        onclick="showBulkTagModal()"
                        style="background: linear-gradient(135deg, #10b981 0%, #059669 100%)"
                    >
                        <i class="fas fa-tags"></i>
                        G√°n Tag H√†ng Lo·∫°t
                    </button>
                    <button
                        class="btn-primary btn-column-settings"
                        onclick="openColumnSettingsModal()"
                        style="background: #8b5cf6"
                    >
                        <i class="fas fa-columns"></i>
                        C√†i ƒë·∫∑t c·ªôt
                    </button>
                </div>
            </div>

            <!-- Unified Filter & Search Section -->
            <div class="unified-filter-section" id="unifiedFilterSection">
                <!-- Row 1: Search + Date Filters -->
                <div class="filter-row">
                    <!-- Search -->
                    <div class="search-wrapper">
                        <i class="fas fa-search search-icon"></i>
                        <input
                            type="text"
                            class="search-input"
                            id="tableSearchInput"
                            placeholder="T√¨m theo t√™n, SƒêT, m√£ ƒë∆°n..."
                            oninput="performTableSearch()"
                            autocomplete="off"
                        />
                        <button class="search-clear" id="searchClearBtn" onclick="clearSearch()">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>

                    <!-- Date Quick Filters -->
                    <div class="date-filter-group">
                        <button
                            class="date-filter-btn active"
                            data-range="all"
                            onclick="setDateFilter('all')"
                        >
                            T·∫•t c·∫£
                        </button>
                        <button
                            class="date-filter-btn"
                            data-range="today"
                            onclick="setDateFilter('today')"
                        >
                            H√¥m nay
                        </button>
                        <button
                            class="date-filter-btn"
                            data-range="yesterday"
                            onclick="setDateFilter('yesterday')"
                        >
                            H√¥m qua
                        </button>
                        <button
                            class="date-filter-btn"
                            data-range="3days"
                            onclick="setDateFilter('3days')"
                        >
                            3N
                        </button>
                        <button
                            class="date-filter-btn"
                            data-range="7days"
                            onclick="setDateFilter('7days')"
                        >
                            7N
                        </button>
                        <button
                            class="date-filter-btn"
                            data-range="15days"
                            onclick="setDateFilter('15days')"
                        >
                            15N
                        </button>
                        <button
                            class="date-filter-btn"
                            data-range="custom"
                            onclick="toggleCustomDateRange()"
                        >
                            <i class="fas fa-calendar-alt"></i>
                        </button>
                    </div>

                    <!-- Custom Date Range (hidden by default) -->
                    <div class="custom-date-range" id="customDateRange" style="display: none">
                        <input type="date" id="dateFrom" onchange="applyCustomDateRange()" />
                        <span>‚Üí</span>
                        <input type="date" id="dateTo" onchange="applyCustomDateRange()" />
                    </div>
                </div>

                <!-- Row 2: Status, Source, Tag Filters + Result Count -->
                <div class="filter-row">
                    <!-- Status Filter -->
                    <div class="filter-item">
                        <label>Tr·∫°ng th√°i:</label>
                        <select
                            id="statusFilter"
                            onchange="performTableSearch()"
                            class="search-filter-select"
                        >
                            <option value="all" selected>T·∫•t c·∫£</option>
                            <option value="draft">Nh√°p</option>
                            <option value="processing">ƒêang x·ª≠ l√Ω</option>
                            <option value="completed">Ho√†n th√†nh</option>
                            <option value="cancelled">ƒê√£ h·ªßy</option>
                        </select>
                    </div>

                    <!-- Source Filter -->
                    <div class="filter-item">
                        <label>Ngu·ªìn:</label>
                        <select
                            id="sourceFilter"
                            onchange="performTableSearch()"
                            class="search-filter-select"
                        >
                            <option value="all" selected>T·∫•t c·∫£</option>
                            <option value="manual">Th·ªß c√¥ng</option>
                            <option value="facebook_post">Facebook Post</option>
                            <option value="instagram">Instagram</option>
                            <option value="tiktok">TikTok</option>
                        </select>
                    </div>

                    <!-- TAG Filter -->
                    <div class="filter-item">
                        <label>TAG:</label>
                        <select
                            id="tagFilter"
                            onchange="performTableSearch()"
                            class="search-filter-select"
                        >
                            <option value="all" selected>T·∫•t c·∫£</option>
                            <!-- Options populated by JS -->
                        </select>
                    </div>

                    <!-- Spacer -->
                    <div style="flex: 1"></div>

                    <!-- Result Count & Reload -->
                    <div class="filter-result">
                        <span class="search-result-count" id="searchResultCount">0</span>
                        <span>k·∫øt qu·∫£</span>
                        <button class="btn-reload" onclick="loadOrders()" title="T·∫£i l·∫°i">
                            <i class="fas fa-sync"></i>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Action Buttons Section (when orders selected) -->
            <div
                class="action-buttons-section"
                style="padding: 16px 24px; display: none; gap: 12px; flex-wrap: wrap"
                id="actionButtonsSection"
            >
                <div style="display: flex; gap: 8px; align-items: center">
                    <span style="color: #6b7280; font-size: 13px; font-weight: 500">
                        <span id="selectedOrdersCount">0</span> ƒë∆°n ƒë∆∞·ª£c ch·ªçn
                    </span>
                </div>
                <button
                    class="btn-primary"
                    onclick="deleteSelectedOrders()"
                    style="background: #ef4444"
                >
                    <i class="fas fa-trash"></i>
                    X√≥a ƒë√£ ch·ªçn
                </button>
            </div>

            <!-- Table Container -->
            <div class="table-container" id="tableContainer">
                <div class="table-wrapper" id="tableWrapper">
                    <table class="table">
                        <thead>
                            <tr>
                                <th>
                                    <input
                                        type="checkbox"
                                        id="selectAll"
                                        onchange="toggleSelectAll()"
                                    />
                                </th>
                                <th data-column="actions">Thao t√°c</th>
                                <th data-column="stt">STT</th>
                                <th data-column="tag">TAG</th>
                                <th data-column="customer">Kh√°ch h√†ng</th>
                                <th data-column="phone">SƒêT</th>
                                <th data-column="chat">Chat</th>
                                <th data-column="products">S·∫£n ph·∫©m</th>
                                <th data-column="post">B√†i Post</th>
                                <th data-column="address">ƒê·ªãa ch·ªâ</th>
                                <th data-column="total">T·ªïng</th>
                                <th data-column="created-date">Ng√†y t·∫°o</th>
                                <th data-column="status">Tr·∫°ng th√°i</th>
                            </tr>
                        </thead>
                        <tbody id="tableBody">
                            <tr>
                                <td colspan="13" style="text-align: center; padding: 40px">
                                    <i class="fas fa-spinner fa-spin"></i> ƒêang t·∫£i...
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <!-- Pagination Info -->
                <div class="pagination-wrapper">
                    <div id="pageInfo">Hi·ªÉn th·ªã 0 - 0 c·ªßa 0</div>
                </div>
            </div>
        </div>

        <!-- Create/Edit Order Modal -->
        <div class="modal-overlay" id="orderModalOverlay">
            <div class="modal-content modal-large">
                <div class="modal-header">
                    <h3 id="orderModalTitle">
                        <i class="fas fa-plus-circle"></i>
                        T·∫°o ƒë∆°n h√†ng m·ªõi
                    </h3>
                    <button class="modal-close" onclick="closeOrderModal()">√ó</button>
                </div>
                <div class="modal-body">
                    <form id="orderForm">
                        <!-- Customer Info -->
                        <div class="form-section">
                            <h4><i class="fas fa-user"></i> Th√¥ng tin kh√°ch h√†ng</h4>
                            <div class="form-row">
                                <div class="form-group">
                                    <label>T√™n kh√°ch h√†ng <span class="required">*</span></label>
                                    <input
                                        type="text"
                                        id="customerName"
                                        placeholder="Nh·∫≠p t√™n kh√°ch h√†ng"
                                        required
                                    />
                                </div>
                                <div class="form-group">
                                    <label>S·ªë ƒëi·ªán tho·∫°i <span class="required">*</span></label>
                                    <input
                                        type="tel"
                                        id="customerPhone"
                                        placeholder="0901234567"
                                        required
                                    />
                                </div>
                            </div>
                            <div class="form-group">
                                <label>ƒê·ªãa ch·ªâ</label>
                                <input
                                    type="text"
                                    id="customerAddress"
                                    placeholder="S·ªë nh√†, ƒë∆∞·ªùng, ph∆∞·ªùng/x√£, qu·∫≠n/huy·ªán, t·ªânh/th√†nh"
                                />
                            </div>
                        </div>

                        <!-- Post Info -->
                        <div class="form-section">
                            <h4><i class="fas fa-link"></i> Ngu·ªìn ƒë∆°n</h4>
                            <div class="form-row">
                                <div class="form-group">
                                    <label>Link b√†i Post</label>
                                    <input
                                        type="url"
                                        id="postUrl"
                                        placeholder="https://facebook.com/..."
                                    />
                                </div>
                                <div class="form-group">
                                    <label>Ngu·ªìn</label>
                                    <select id="orderSource">
                                        <option value="manual">Th·ªß c√¥ng</option>
                                        <option value="facebook_post">Facebook Post</option>
                                        <option value="instagram">Instagram</option>
                                        <option value="tiktok">TikTok</option>
                                    </select>
                                </div>
                            </div>
                        </div>

                        <!-- Products -->
                        <div class="form-section">
                            <h4><i class="fas fa-box"></i> S·∫£n ph·∫©m</h4>
                            <div class="product-search-wrapper">
                                <i class="fas fa-search"></i>
                                <input
                                    type="text"
                                    id="productSearchInput"
                                    placeholder="T√¨m s·∫£n ph·∫©m ƒë·ªÉ th√™m..."
                                    oninput="searchProducts()"
                                />
                                <div class="product-search-results" id="productSearchResults"></div>
                            </div>
                            <div class="products-list" id="orderProductsList">
                                <div class="products-empty">
                                    <i class="fas fa-shopping-basket"></i>
                                    <p>Ch∆∞a c√≥ s·∫£n ph·∫©m. T√¨m ki·∫øm ƒë·ªÉ th√™m.</p>
                                </div>
                            </div>
                            <div class="products-summary" id="productsSummary">
                                <div class="summary-row">
                                    <span>T·ªïng SL:</span>
                                    <strong id="summaryQuantity">0 c√°i</strong>
                                </div>
                                <div class="summary-row total">
                                    <span>T·ªïng ti·ªÅn:</span>
                                    <strong id="summaryTotal">0ƒë</strong>
                                </div>
                            </div>
                        </div>

                        <!-- Note -->
                        <div class="form-section">
                            <h4><i class="fas fa-sticky-note"></i> Ghi ch√∫</h4>
                            <div class="form-group">
                                <textarea
                                    id="orderNote"
                                    rows="2"
                                    placeholder="Ghi ch√∫ cho ƒë∆°n h√†ng..."
                                ></textarea>
                            </div>
                        </div>

                        <!-- Hidden fields -->
                        <input type="hidden" id="orderId" />
                        <input type="hidden" id="orderProducts" value="[]" />
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn-secondary" onclick="closeOrderModal()">
                        H·ªßy
                    </button>
                    <button type="button" class="btn-primary btn-save" onclick="saveOrder()">
                        <i class="fas fa-save"></i>
                        L∆∞u ƒë∆°n h√†ng
                    </button>
                </div>
            </div>
        </div>

        <!-- Tag Modal (clone from tab1) -->
        <div class="tag-modal" id="tagModal">
            <div class="tag-modal-content">
                <div class="tag-modal-header">
                    <button class="tag-btn-save-header" onclick="saveOrderTags()">
                        L∆∞u (Ctrl + Enter)
                    </button>
                    <button class="tag-modal-close" onclick="closeTagModal()">√ó</button>
                </div>
                <div class="tag-modal-body">
                    <div class="tag-input-container">
                        <div class="selected-tags-pills" id="selectedTagsPills"></div>
                        <input
                            type="text"
                            id="tagSearchInput"
                            class="tag-add-input"
                            placeholder="T√¨m tag..."
                            oninput="filterTags()"
                            onkeydown="handleTagInputKeydown(event)"
                        />
                    </div>
                    <div class="tag-dropdown-list" id="tagList">
                        <div class="no-tags-message">
                            <i class="fas fa-spinner fa-spin"></i>
                            <p>ƒêang t·∫£i danh s√°ch tag...</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Confirm Delete Modal -->
        <div class="modal-overlay" id="confirmDeleteModal">
            <div class="modal-content" style="max-width: 400px">
                <div class="modal-header">
                    <h3>
                        <i class="fas fa-exclamation-triangle" style="color: #ef4444"></i> X√°c nh·∫≠n
                        x√≥a
                    </h3>
                    <button class="modal-close" onclick="closeConfirmDeleteModal()">√ó</button>
                </div>
                <div class="modal-body" style="text-align: center; padding: 24px">
                    <p id="confirmDeleteMessage">B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a ƒë∆°n n√†y?</p>
                </div>
                <div class="modal-footer" style="justify-content: center">
                    <button type="button" class="btn-secondary" onclick="closeConfirmDeleteModal()">
                        H·ªßy
                    </button>
                    <button
                        type="button"
                        class="btn-primary"
                        style="background: #ef4444"
                        onclick="confirmDelete()"
                    >
                        <i class="fas fa-trash"></i>
                        X√≥a
                    </button>
                </div>
            </div>
        </div>

        <!-- Column Settings Modal -->
        <div class="column-settings-modal" id="columnSettingsModal">
            <div class="column-settings-modal-content">
                <div class="column-settings-modal-header">
                    <h3><i class="fas fa-columns"></i> C√†i ƒë·∫∑t hi·ªÉn th·ªã c·ªôt</h3>
                    <button
                        class="column-settings-modal-close"
                        onclick="closeColumnSettingsModal()"
                    >
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="column-settings-modal-body">
                    <p style="color: #6b7280; font-size: 13px; margin-bottom: 16px">
                        Ch·ªçn c√°c c·ªôt b·∫°n mu·ªën hi·ªÉn th·ªã trong b·∫£ng:
                    </p>
                    <div class="column-settings-list" id="columnSettingsList">
                        <label class="column-setting-item">
                            <input type="checkbox" data-column="actions" checked />
                            <span>Thao t√°c</span>
                        </label>
                        <label class="column-setting-item">
                            <input type="checkbox" data-column="stt" checked />
                            <span>STT</span>
                        </label>
                        <label class="column-setting-item">
                            <input type="checkbox" data-column="tag" checked />
                            <span>TAG</span>
                        </label>
                        <label class="column-setting-item">
                            <input type="checkbox" data-column="customer" checked />
                            <span>Kh√°ch h√†ng</span>
                        </label>
                        <label class="column-setting-item">
                            <input type="checkbox" data-column="phone" checked />
                            <span>S·ªë ƒëi·ªán tho·∫°i</span>
                        </label>
                        <label class="column-setting-item">
                            <input type="checkbox" data-column="chat" checked />
                            <span>Chat</span>
                        </label>
                        <label class="column-setting-item">
                            <input type="checkbox" data-column="products" checked />
                            <span>S·∫£n ph·∫©m</span>
                        </label>
                        <label class="column-setting-item">
                            <input type="checkbox" data-column="post" checked />
                            <span>B√†i Post</span>
                        </label>
                        <label class="column-setting-item">
                            <input type="checkbox" data-column="address" />
                            <span>ƒê·ªãa ch·ªâ</span>
                        </label>
                        <label class="column-setting-item">
                            <input type="checkbox" data-column="total" checked />
                            <span>T·ªïng ti·ªÅn</span>
                        </label>
                        <label class="column-setting-item">
                            <input type="checkbox" data-column="created-date" checked />
                            <span>Ng√†y t·∫°o</span>
                        </label>
                        <label class="column-setting-item">
                            <input type="checkbox" data-column="status" checked />
                            <span>Tr·∫°ng th√°i</span>
                        </label>
                    </div>
                </div>
                <div class="column-settings-modal-footer">
                    <button class="column-settings-btn-reset" onclick="resetColumnSettings()">
                        <i class="fas fa-undo"></i> ƒê·∫∑t l·∫°i m·∫∑c ƒë·ªãnh
                    </button>
                    <div style="display: flex; gap: 8px">
                        <button
                            class="column-settings-btn-cancel"
                            onclick="closeColumnSettingsModal()"
                        >
                            H·ªßy
                        </button>
                        <button class="column-settings-btn-save" onclick="saveColumnSettings()">
                            <i class="fas fa-save"></i> L∆∞u
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Shared Scripts -->
        <script src="../shared/js/firebase-config.js"></script>
        <script src="../shared/js/shared-auth-manager.js"></script>
        <script src="../shared/js/notification-system.js"></script>

        <!-- Tab Social Scripts -->
        <script src="js/tab-social/tab-social-core.js"></script>
        <script src="js/tab-social/tab-social-column-visibility.js"></script>
        <script src="js/tab-social/tab-social-table.js"></script>
        <script src="js/tab-social/tab-social-modal.js"></script>
        <script src="js/tab-social/tab-social-firebase.js"></script>
        <script src="js/tab-social/tab-social-tags.js"></script>
    </body>
</html>
