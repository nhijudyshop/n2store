<!--
  Firebase Statistics Dashboard
  Thống kê toàn bộ dữ liệu Firebase sử dụng trong dự án
-->
<!doctype html>
<html lang="vi">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Firebase Statistics - N2 Shop</title>
    <meta http-equiv="Cache-Control" content="public, max-age=31536000" />

    <!-- External CSS -->
    <link rel="stylesheet" href="css/firebase-stats.css" />

    <!-- Lucide Icons -->
    <script type="module" src="../shared/esm/compat.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>

    <!-- Firebase Scripts -->
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-database-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.0.0/firebase-auth-compat.js"></script>

    <!-- Navigation -->
    <script defer src="../shared/js/navigation-modern.js"></script>
</head>

<body>
    <!-- Access Denied (Hidden by default) -->
    <div id="accessDenied" class="access-denied" style="display: none">
        <h1>
            <i data-lucide="shield-x"></i>
            Truy cập bị từ chối
        </h1>
        <p>Bạn không có quyền truy cập vào trang này.</p>
        <a href="../live/index.html" class="btn btn-primary">
            <i data-lucide="arrow-left"></i>
            Quay về trang chính
        </a>
    </div>

    <!-- Main Container -->
    <div id="mainContainer" style="display: none">
        <!-- Sidebar Navigation -->
        <aside class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <i data-lucide="zap"></i>
                    <span>N2Shop</span>
                </div>
                <button class="sidebar-toggle" id="sidebarToggle">
                    <i data-lucide="panel-left-close"></i>
                </button>
            </div>

            <nav class="sidebar-nav" id="sidebarNav">
                <!-- Menu items will be auto-generated by navigation-modern.js -->
            </nav>

            <div class="sidebar-footer">
                <div class="user-info">
                    <div class="user-avatar">
                        <i data-lucide="user-circle"></i>
                    </div>
                    <div class="user-details">
                        <div class="user-name" id="userName">Admin</div>
                        <div class="user-role">Quản trị viên</div>
                    </div>
                </div>
                <button class="btn-logout" id="btnLogout">
                    <i data-lucide="log-out"></i>
                    <span>Đăng xuất</span>
                </button>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Top Bar -->
            <header class="top-bar">
                <div class="top-bar-left">
                    <button class="mobile-menu-btn" id="mobileMenuBtn">
                        <i data-lucide="menu"></i>
                    </button>
                    <h1 class="page-title">
                        <i data-lucide="database"></i>
                        Firebase Statistics
                    </h1>
                </div>
                <div class="top-bar-right">
                    <button class="btn btn-primary" id="btnRefresh">
                        <i data-lucide="refresh-cw"></i>
                        <span>Refresh</span>
                    </button>
                </div>
            </header>

            <!-- Content Area -->
            <div class="content-area">
                <!-- Summary Cards -->
                <div class="summary-cards">
                    <div class="summary-card firestore">
                        <div class="card-icon">
                            <i data-lucide="database"></i>
                        </div>
                        <div class="card-info">
                            <span class="card-label">Firestore Collections</span>
                            <span class="card-value" id="firestoreCount">--</span>
                        </div>
                    </div>
                    <div class="summary-card realtime">
                        <div class="card-icon">
                            <i data-lucide="activity"></i>
                        </div>
                        <div class="card-info">
                            <span class="card-label">Realtime DB Nodes</span>
                            <span class="card-value" id="realtimeCount">--</span>
                        </div>
                    </div>
                    <div class="summary-card storage">
                        <div class="card-icon">
                            <i data-lucide="hard-drive"></i>
                        </div>
                        <div class="card-info">
                            <span class="card-label">Storage Buckets</span>
                            <span class="card-value" id="storageCount">1</span>
                        </div>
                    </div>
                    <div class="summary-card auth">
                        <div class="card-icon">
                            <i data-lucide="users"></i>
                        </div>
                        <div class="card-info">
                            <span class="card-label">Auth Method</span>
                            <span class="card-value" id="authMethod">Anonymous</span>
                        </div>
                    </div>
                </div>

                <!-- Tabs -->
                <div class="tabs-container">
                    <div class="tabs">
                        <button class="tab active" data-tab="firestore">
                            <i data-lucide="database"></i>
                            Firestore
                        </button>
                        <button class="tab" data-tab="realtime">
                            <i data-lucide="activity"></i>
                            Realtime Database
                        </button>
                        <button class="tab" data-tab="storage">
                            <i data-lucide="hard-drive"></i>
                            Storage
                        </button>
                        <button class="tab" data-tab="auth">
                            <i data-lucide="shield"></i>
                            Authentication
                        </button>
                    </div>
                </div>

                <!-- Tab Contents -->
                <div class="tab-content active" id="tab-firestore">
                    <div class="section-header">
                        <h2>
                            <i data-lucide="database"></i>
                            Firestore Collections
                        </h2>
                        <span class="badge">Cloud Firestore</span>
                    </div>
                    <div class="data-table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Collection</th>
                                    <th>Mô tả</th>
                                    <th>Module sử dụng</th>
                                    <th>Trạng thái</th>
                                </tr>
                            </thead>
                            <tbody id="firestoreTable">
                                <!-- Data will be populated by JS -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="tab-content" id="tab-realtime">
                    <div class="section-header">
                        <h2>
                            <i data-lucide="activity"></i>
                            Realtime Database Nodes
                        </h2>
                        <span class="badge warning">Legacy - Consider Migration</span>
                    </div>

                    <!-- Filter buttons -->
                    <div class="filter-buttons">
                        <button class="filter-btn active" data-filter="all">Tất cả</button>
                        <button class="filter-btn" data-filter="active">Đang dùng</button>
                        <button class="filter-btn" data-filter="deletable">Có thể xóa</button>
                        <button class="filter-btn" data-filter="migration">Cần migrate</button>
                    </div>

                    <div class="data-table-container">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Node</th>
                                    <th>Mô tả</th>
                                    <th>Số files sử dụng</th>
                                    <th>Trạng thái</th>
                                </tr>
                            </thead>
                            <tbody id="realtimeTable">
                                <!-- Data will be populated by JS -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="tab-content" id="tab-storage">
                    <div class="section-header">
                        <h2>
                            <i data-lucide="hard-drive"></i>
                            Firebase Storage
                        </h2>
                        <span class="badge success">Active</span>
                    </div>
                    <div class="storage-info">
                        <div class="storage-card">
                            <div class="storage-icon">
                                <i data-lucide="folder"></i>
                            </div>
                            <div class="storage-details">
                                <h3>Default Bucket</h3>
                                <p class="bucket-name">n2shop-69e37-ne0q1</p>
                                <p class="bucket-desc">Lưu trữ hình ảnh sản phẩm, avatar, và các file upload</p>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="tab-content" id="tab-auth">
                    <div class="section-header">
                        <h2>
                            <i data-lucide="shield"></i>
                            Authentication
                        </h2>
                        <span class="badge">Firebase Auth</span>
                    </div>
                    <div class="auth-info">
                        <div class="auth-card">
                            <div class="auth-method">
                                <i data-lucide="user-x"></i>
                                <h3>Anonymous Authentication</h3>
                            </div>
                            <p>Hệ thống sử dụng <strong>Anonymous Auth</strong> kết hợp với custom user management trong Firestore collection <code>users</code>.</p>
                            <div class="auth-flow">
                                <div class="flow-step">
                                    <span class="step-num">1</span>
                                    <span>User nhập username/password</span>
                                </div>
                                <div class="flow-arrow">
                                    <i data-lucide="arrow-right"></i>
                                </div>
                                <div class="flow-step">
                                    <span class="step-num">2</span>
                                    <span>Verify với Firestore <code>users</code></span>
                                </div>
                                <div class="flow-arrow">
                                    <i data-lucide="arrow-right"></i>
                                </div>
                                <div class="flow-step">
                                    <span class="step-num">3</span>
                                    <span>signInAnonymously() để lấy UID</span>
                                </div>
                                <div class="flow-arrow">
                                    <i data-lucide="arrow-right"></i>
                                </div>
                                <div class="flow-step">
                                    <span class="step-num">4</span>
                                    <span>Lưu session vào localStorage</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Project Info -->
                <div class="project-info">
                    <h3>
                        <i data-lucide="info"></i>
                        Thông tin Firebase Project
                    </h3>
                    <div class="info-grid">
                        <div class="info-item">
                            <span class="info-label">Project ID</span>
                            <span class="info-value">n2shop-69e37</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Database Location</span>
                            <span class="info-value">asia-southeast1 (Singapore)</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Firestore Location</span>
                            <span class="info-value">nam5</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Plan</span>
                            <span class="info-value">Blaze (Pay as you go)</span>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Firebase Stats Script -->
    <script src="js/firebase-stats.js"></script>
</body>

</html>
